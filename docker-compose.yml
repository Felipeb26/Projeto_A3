version: '3.9'

services:
  gates:
    image: a3/gate
    build: ./Gateway
    ports:
      - 3001:3001
    restart: on-failure
    networks:
      serveros:
    cpu_count: 1
    mem_limit: 100m
    # depends_on:
    # - mail
    # - back

  back:
    image: a3/back
    build: ./BACK
    ports:
      - 3000:3000
    restart: on-failure
    networks:
      serveros:
    cpu_count: 1
    mem_limit: 100m

  mail:
    image: a3/mail
    build: ./MAIL
    ports:
      - 3003:3003
    restart: on-failure
    networks:
      serveros:
    cpu_count: 1
    mem_limit: 100m

networks:
    serveros:
      external: false
      driver: bridge
      ipam:
        driver: default
        config:
          - subnet: 172.18.1.0/24